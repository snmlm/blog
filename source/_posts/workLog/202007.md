---
title: 工作日志202007
categories: 工作日志
tags: 
	- 工作日志
---
 <meta name="referrer" content="no-referrer" /><!-- more -->
#### 6
* 反洗钱数据整理
 * CustomerIdv 数据重复问题。是存过中日期写死导致。方案：需修改存过，重新执行存过，日期从2019-08-23至今。
 * 可疑数据的丢失，中间表数据有，业务表数据没有。由于定时的时间问题，抽取在数据进入之前执行的。方案：修改抽取定时和推数定时，重新抽取，日期从2019-11-02至今，刨除2020-03-01。
* COREPRPALL-1090，auto上uat出现了问题，mongodb配置加载不上，写死之后，启动出现内存溢出问题，仍未解决。

#### 7
* COREPRPALL-1090，auto上uat出现了问题，mongodb配置加载不上，写死之后，启动出现内存溢出问题，仍未解决。
* 分期退保，剩余期次的税不足保单总税的时候，缴费计划表中会出现正值的税。原因：代码中未考虑这个情况。方案：把不足的地方在最后一期上修正。
* SHENGCHAN-3800 数据修正。
* 发现bug，计算时，少除100

#### 8
* COREPRPALL-1090，auto上uat出现了问题，mongodb配置加载不上，写死之后，启动出现内存溢出问题，仍未解决。
* 昨日没有除100的bug，检查生产数据，数据没问题，有16条数据有问题，但是都是冷数据，大部分都是退保或过期的。代码不是我这里修改。
* 销管代码本地部署完成。
* SHENGCHAN-3809 提数

#### 9
* COREPRPALL-1090，auto上uat出现了问题，mongodb配置加载不上，写死之后，启动出现内存溢出问题，仍未解决。
* SHENGCHAN-3809 提数
* 梳理销管信息技术费结算代码。

#### 10
* 梳理销管信息技术费结算代码。

#### 13
* 报工，赠险标志，mongodb
* 反洗钱数据治理，重新抽取客户信息，大额和可疑信息。

#### 14
* 反洗钱数据治理，重新抽取客户信息，大额和可疑信息。
 * 发现数据中，人员代码有些问题，中间表数据就不对，销管送的数据有问题。

#### 15
* 反洗钱数据治理，重新抽取客户信息，大额和可疑信息。
* 开发销管信息技术费追加结算功能。
 * certino改为Z0001开头，后续不变
 * prpjcommplan_xxjsf追加新条数，用于存放追加数据。
 * prpjcommplan_xxjsfhis, 追加新条数（无所谓了）
 * 查询是拿已结算的信息技术费？要拿最新的结算的东西吗？
* 构思报文校验功能（大报文，多层嵌套，空值必传数值校验，模板化，可配置）
 * 逐个字段比对？
 * 比对模板，什么样子的？
* 博客 显示pdf，插件可以同，本地显示可以，远程显示就不行了，而且加载很慢。（pdf太大了？已放弃）

#### 16
* 开发销管信息技术费追加结算功能。
 * 今天没工夫弄，22号之前弄完，23号提测
* COREPRPALL-1090生产升级
 * 加个字段，后方3个系统都要。。。。升级好麻烦
 * common打包
 * 承保应用打包升级
 * auto-dubbo打包升级
 * common-dubbo
 * 异步转发系统打包升级
 * reins-dubbo打包升级
* 升级好麻烦，打算弄个自动升级的
 * 有现成的自动化部署的中间件，没研究过
 * 自己写一个？有构思

#### 20
* 开发销管信息技术费追加结算功能。

#### 21
* 开发销管信息技术费追加结算功能。
 * 先查出已结算的。排序，分组
 * 设置费率。计算信息技术费
 * 尾差处理。前面已经排完序，有多少处理多少，子表，一条直接处理，多条，处理前两条。
* 发现数据库死锁问题
 * 事务很大，事务中有删除，插入。
 * 在并发情况下，多事务同事提交，删除一方会因为锁膨胀的原因，持有更多的行锁，导致其他事务插入时无法拿到全部的行锁，进而相互持有，相互等待。
 * 在事务中，尽量不要去进行数据交互，因为事务是否成功，不会影响数据的交互，进而会发生数据交互完毕，而事务落库失败。
 * 这里有一个事务什么时候提交的衍生问题。